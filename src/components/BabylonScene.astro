<canvas id="renderCanvas"></canvas>

<script>
import { Engine } from "@babylonjs/core/Engines/engine";
import { Scene } from "@babylonjs/core/scene";
import { UniversalCamera } from "@babylonjs/core/Cameras/universalCamera";
import { Vector3 } from "@babylonjs/core/Maths/math.vector";
import { Color4 } from "@babylonjs/core/Maths/math.color";
import { ImportMeshAsync } from "@babylonjs/core/Meshes/mesh";
import "@babylonjs/loaders/";

//import { Inspector } from '@babylonjs/inspector';

const canvas = document.getElementById("renderCanvas") as HTMLCanvasElement;
const engine = new Engine(canvas, true, {antialias: false, powerPreference: "high-performance"});

const createScene = async () => {
	const scene = new Scene(engine);

	scene.clearColor = new Color4(0.2, 0.15, 0.1, 1);

	const camera = new UniversalCamera("camera", new Vector3(0, 0, 0), scene);
	camera.minZ = 0.1;
	camera.maxZ = 200; 
	//camera.fov = 1.8;	

	camera.inputs.addMouseWheel();
	camera.inputs.addTouch();
	camera.inputs.attached.mousewheel.wheelPrecisionX = 0.2;
	camera.inputs.attached.mousewheel.wheelPrecisionY = 0.2;
	camera.inputs.attached.mousewheel.wheelPrecisionZ = 0.2;
	camera.speed = 0.3;

	camera.rotation.y = Math.PI * 3.2;
	camera.position = new Vector3(7.15, 1.75, 8.94);
	camera.attachControl(canvas, true);

	const result = await ImportMeshAsync("/sog/scene5.sog", scene);
	const gaussianSplattingMesh = result.meshes[0];

	console.log(gaussianSplattingMesh.material);

	gaussianSplattingMesh.position.y = -2;
	//Inspector.Show(scene, {});

	return scene;
};

const main = async () => {
	const scene = await createScene();
	engine.runRenderLoop(() => {
		if (scene) {
			scene.render();
		}
	});
};

main();

window.addEventListener("resize", () => {
	engine.resize();
});
</script>
